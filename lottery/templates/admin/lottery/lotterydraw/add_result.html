<!-- Path: lottery/templates/admin/lottery/lotterydraw/add_result.html -->
{% extends "admin/change_form.html" %}
{% load static %}
{% load i18n admin_urls %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .prize-header {
            background-color: #004aad;
            color: white;
            padding: 10px;
            margin: 15px 0;
            border-radius: 4px;
            font-weight: bold;
            text-align: center;
            font-size: 18px;
        }
        
        .prize-box {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 15px;
        }
        
        .prize-title {
            background-color: #004aad;
            color: white;
            padding: 8px;
            border-radius: 4px 4px 0 0;
            font-weight: bold;
            text-align: center;
        }
        
        .prize-amount {
            font-size: 1.5em;
            text-align: center;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .field-ticket_number input {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .field-place input {
            text-transform: uppercase;
        }
        
        .prize-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-gap: 5px;
            margin-top: 10px;
        }
        
        .prize-grid-item {
            background-color: white;
            border: 1px solid #ddd;
            padding: 5px;
            text-align: center;
        }
        
        .bulk-entry-container textarea {
            min-height: 100px;
            font-family: monospace;
        }
        
        /* Make the prize tables more like your screenshots */
        .inline-related h3 {
            background-color: #004aad;
            color: white;
            padding: 10px;
            border-radius: 4px 4px 0 0;
        }
        
        .inline-related fieldset {
            border: 1px solid #ddd;
            border-radius: 0 0 4px 4px;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        /* Make sure all input fields look consistent */
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

    /* Fixed save button with improved styling */
        .submit-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #f8f8f8;
            padding: 12px 15px;
            z-index: 1000;
            box-shadow: 0px -2px 5px rgba(0, 0, 0, 0.1);
            margin: 0;
            border-top: 1px solid #ddd;
            display: flex;
            align-items: center;
        }

        /* Add padding to prevent content overlap */
        #content {
            padding-bottom: 65px;
        }

        /* Fixed save button with improved styling */
        .submit-row {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #f8f8f8;
            padding: 12px 15px;
            z-index: 1000;
            box-shadow: 0px -2px 5px rgba(0, 0, 0, 0.1);
            margin: 0;
            border-top: 1px solid #ddd;
            display: flex;
            align-items: center;
        }

        /* Add padding to prevent content overlap */
        #content {
            padding-bottom: 65px;
        }

        /* Match button styling to your interface */
        .submit-row input[type="submit"], 
        .submit-row a.deletelink {
            border-radius: 4px;
            border: none;
            padding: 10px 20px;
            font-weight: normal;
            font-size: 14px;
            margin-right: 8px;
            transition: background-color 0.2s;
            cursor: pointer;
        }

        .submit-row input.default {
            background-color: #004aad; /* Match your blue header color */
            color: white;
            font-weight: 600;
        }

        .submit-row input[type="submit"] {
            background-color: #417690;
            color: white;
        }

        .submit-row input[type="submit"]:hover,
        .submit-row input.default:hover {
            background-color: #003d91; /* Slightly darker on hover */
        }

        .submit-row a.deletelink {
            background-color: #ba2121;
            color: white;
            float: right;
            margin-left: auto;
        }

        .submit-row a.deletelink:hover {
            background-color: #a41515;
        }

        /* Fix spacing between buttons */
        .submit-row > * {
            margin-right: 10px;
        }

        .submit-row > *:last-child {
            margin-right: 0;
        }
    </style>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // JavaScript to enhance the form
            const sixthPrizeTextarea = document.getElementById('id_bulk_sixth_prizes');
            const seventhPrizeTextarea = document.getElementById('id_bulk_seventh_prizes');
            const eighthPrizeTextarea = document.getElementById('id_bulk_eighth_prizes');
            const ninthPrizeTextarea = document.getElementById('id_bulk_ninth_prizes');
            const tenthPrizeTextarea = document.getElementById('id_bulk_tenth_prizes');
            
            // Function to normalize input (strip leading/trailing whitespace, deduplicate, etc.)
            function normalizeInput(textarea) {
                if (!textarea) return;
                
                textarea.addEventListener('blur', function() {
                    const values = textarea.value.split(/[\s,]+/).filter(v => v.trim());
                    const uniqueValues = [...new Set(values)];
                    textarea.value = uniqueValues.join('\n');
                });
            }
            
            normalizeInput(sixthPrizeTextarea);
            normalizeInput(seventhPrizeTextarea);
            normalizeInput(eighthPrizeTextarea);
            normalizeInput(ninthPrizeTextarea);
            normalizeInput(tenthPrizeTextarea);
        });
    </script>
{% endblock %}

{% block content %}
    <div class="prize-header">
        Lotto App
    </div>
    
    <form {% if has_file_field %}enctype="multipart/form-data" {% endif %}action="{{ form_url }}" method="post" id="{{ opts.model_name }}_form" novalidate>
        {% csrf_token %}
        
        <div class="prize-box">
            <div class="prize-title">Lottery Information</div>
            <div style="padding: 10px;">
                {{ form.lottery_type.label_tag }}
                {{ form.lottery_type }}
                {{ form.lottery_type.errors }}
                
                {{ form.draw_number.label_tag }}
                {{ form.draw_number }}
                {{ form.draw_number.errors }}
                
                {{ form.draw_date.label_tag }}
                {{ form.draw_date }}
                {{ form.draw_date.errors }}
                
                {{ form.result_declared.label_tag }}
                {{ form.result_declared }}
                {{ form.result_declared.errors }}
            </div>
        </div>
        
        <!-- First Prize -->
        <div class="prize-box">
            <div class="prize-title">1st Prize</div>
            <div class="prize-amount">₹ 1,00,00,000/-</div>
            <div style="padding: 10px;">
                <div class="fieldset">
                    <div class="form-row">
                        <div class="field-ticket_number">
                            <label for="id_firstprize-0-ticket_number">Ticket Number:</label>
                            <input type="text" name="firstprize-0-ticket_number" id="id_firstprize-0-ticket_number" maxlength="20" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-place">
                            <label for="id_firstprize-0-place">Place:</label>
                            <input type="text" name="firstprize-0-place" id="id_firstprize-0-place" maxlength="100">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Consolation Prizes -->
        <div class="prize-box">
            <div class="prize-title">Consolation Prize</div>
            <div class="prize-amount">₹ 5,000/-</div>
            <div style="padding: 10px;">
                <p class="help">These will be automatically generated based on the first prize ticket number, using different series (RA, RB, RC, etc.).</p>
            </div>
        </div>
        
        <!-- Second Prize -->
        <div class="prize-box">
            <div class="prize-title">2nd Prize</div>
            <div class="prize-amount">₹ 30,00,000/-</div>
            <div style="padding: 10px;">
                <div class="fieldset">
                    <div class="form-row">
                        <div class="field-ticket_number">
                            <label for="id_secondprize-0-ticket_number">Ticket Number:</label>
                            <input type="text" name="secondprize-0-ticket_number" id="id_secondprize-0-ticket_number" maxlength="20" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-place">
                            <label for="id_secondprize-0-place">Place:</label>
                            <input type="text" name="secondprize-0-place" id="id_secondprize-0-place" maxlength="100">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Third Prize -->
        <div class="prize-box">
            <div class="prize-title">3rd Prize</div>
            <div class="prize-amount">₹ 25,00,000/-</div>
            <div style="padding: 10px;">
                <div class="fieldset">
                    <div class="form-row">
                        <div class="field-ticket_number">
                            <label for="id_thirdprize-0-ticket_number">Ticket Number:</label>
                            <input type="text" name="thirdprize-0-ticket_number" id="id_thirdprize-0-ticket_number" maxlength="20" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-place">
                            <label for="id_thirdprize-0-place">Place:</label>
                            <input type="text" name="thirdprize-0-place" id="id_thirdprize-0-place" maxlength="100">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Fourth Prize -->
        <div class="prize-box">
            <div class="prize-title">4th Prize</div>
            <div class="prize-amount">₹ 15,00,000/-</div>
            <div style="padding: 10px;">
                <div class="fieldset">
                    <div class="form-row">
                        <div class="field-ticket_number">
                            <label for="id_fourthprize-0-ticket_number">Ticket Number:</label>
                            <input type="text" name="fourthprize-0-ticket_number" id="id_fourthprize-0-ticket_number" maxlength="20" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="field-place">
                            <label for="id_fourthprize-0-place">Place:</label>
                            <input type="text" name="fourthprize-0-place" id="id_fourthprize-0-place" maxlength="100">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Fifth Prize -->
        <div class="prize-box">
            <div class="prize-title">5th Prize</div>
            <div class="prize-amount">₹ 1,00,000/-</div>
            <div style="padding: 10px;">
                <fieldset class="module aligned">
                    <div class="inline-group" id="fifthprize-group">
                        <div class="tabular inline-related">
                            <div class="form-row">
                                <label>Ticket Number & Place (one per line):</label>
                                <textarea name="fifth_prizes_bulk" rows="5" placeholder="Format: RX123456 LOCATION&#10;RY789012 LOCATION&#10;RZ345678 LOCATION"></textarea>
                                <p class="help">Enter one ticket per line, with series, number and location separated by space. Example: RA495580 GURUVAYOOR</p>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        
        <!-- Sixth Prize -->
        <div class="prize-box">
            <div class="prize-title">6th Prize</div>
            <div class="prize-amount">₹ 5,000/-</div>
            <div style="padding: 10px;" class="bulk-entry-container">
                {{ form.bulk_sixth_prizes.label_tag }}
                {{ form.bulk_sixth_prizes }}
                {{ form.bulk_sixth_prizes.errors }}
                {{ form.bulk_sixth_prizes.help_text }}
            </div>
        </div>
        
        <!-- Seventh Prize -->
        <div class="prize-box">
            <div class="prize-title">7th Prize</div>
            <div class="prize-amount">₹ 1,000/-</div>
            <div style="padding: 10px;" class="bulk-entry-container">
                {{ form.bulk_seventh_prizes.label_tag }}
                {{ form.bulk_seventh_prizes }}
                {{ form.bulk_seventh_prizes.errors }}
                {{ form.bulk_seventh_prizes.help_text }}
            </div>
        </div>
        
        <!-- Eighth Prize -->
        <div class="prize-box">
            <div class="prize-title">8th Prize</div>
            <div class="prize-amount">₹ 500/-</div>
            <div style="padding: 10px;" class="bulk-entry-container">
                {{ form.bulk_eighth_prizes.label_tag }}
                {{ form.bulk_eighth_prizes }}
                {{ form.bulk_eighth_prizes.errors }}
                {{ form.bulk_eighth_prizes.help_text }}
            </div>
        </div>
        
        <!-- Ninth Prize -->
        <div class="prize-box">
            <div class="prize-title">9th Prize</div>
            <div class="prize-amount">₹ 100/-</div>
            <div style="padding: 10px;" class="bulk-entry-container">
                {{ form.bulk_ninth_prizes.label_tag }}
                {{ form.bulk_ninth_prizes }}
                {{ form.bulk_ninth_prizes.errors }}
                {{ form.bulk_ninth_prizes.help_text }}
            </div>
        </div>
        
        <!-- Tenth Prize -->
        <div class="prize-box">
            <div class="prize-title">10th Prize</div>
            <div class="prize-amount">₹ 50/-</div>
            <div style="padding: 10px;" class="bulk-entry-container">
                {{ form.bulk_tenth_prizes.label_tag }}
                {{ form.bulk_tenth_prizes }}
                {{ form.bulk_tenth_prizes.errors }}
                {{ form.bulk_tenth_prizes.help_text }}
            </div>
        </div>
        
        <div class="submit-row">
            <input type="submit" value="Save" class="default" name="_save">
        </div>
    </form>
{% endblock %}